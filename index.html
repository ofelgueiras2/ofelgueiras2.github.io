<!DOCTYPE html>
<html lang="pt">
    <head>
        <!-- 1) Metas essenciais -->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
        <!-- 2) Título e descrição -->
        <title>Comparador de Tarifários 2025</title>
        <meta name="description"
              content="Comparador de tarifários de eletricidade 2025: calcula em segundos o custo mensal consoante potência contratada, consumo e descontos sociais.">
      
        <!-- 3) CSS principal -->
        <link rel="stylesheet" href="styles.css">
        
        <!-- 4) Tippy.css (preload + link) -->
        <link rel="preload" as="style" href="https://unpkg.com/tippy.js@6/dist/tippy.css">
        <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/dist/tippy.css">
      
        <!-- 5) Prefetch de ícones -->
        <link rel="prefetch" href="icons.svg" as="image" type="image/svg+xml">
      
        <!-- 6) Google Tag (analytics) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-MNLD39E8FB"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());

            // inclui aqui o cookie_domain:
            gtag('config', 'G-MNLD39E8FB', {
                cookie_domain: 'auto'             // ou 'ofelgueiras2.github.io'
            });
        </script>
      </head>
<body>
    <h1 class="dynamic-title">Comparador de Tarifários 2025</h1>


    <div class="parent">
        <!-- 1) Mês + Dias -->
        <div class="div1">
            <div class="month-days-container">
                <div class="monthBlock form-group">
                    <label for="mesSelecionado">Mês</label>
                    <select id="mesSelecionado" class="form-control">
                    </select>
                </div>
                <div class="daysBlock form-group">
                    <label for="dias">Dias</label>
                    <div class="spinner-wrapper">
                      <input
                        type="number"
                        id="dias"
                        class="form-control"
                        value=""
                        min="0"
                        step="any"
                      />
                      <div class="spinner">
                        <button
                          type="button"
                          class="spinner-btn spinner-up"
                          aria-label="Aumentar Dias"
                        >
                          <svg class="spinner-arrow-svg" width="12" height="8">
                            <use href="icons.svg#arrow-up"></use>
                          </svg>
                        </button>
                        <button
                          type="button"
                          class="spinner-btn spinner-down"
                          aria-label="Diminuir Dias"
                        >
                          <svg class="spinner-arrow-svg" width="12" height="8">
                            <use href="icons.svg#arrow-down"></use>
                          </svg>
                        </button>
                      </div>
                    </div>
                  </div>
                  
            </div>
        </div>
        <!-- 3) .btnDias com o único btnDias -->
        
        <button id="btnDias" class="btn-icon" title="OMIE / Intervalo de datas" style="width:50px;height:30px;border:1px solid #ccc;
                    border-radius:5px;
                    display:flex;align-items:center;justify-content:center;
                    gap:0px;cursor:pointer;">
            <svg aria-hidden="true" class="chevron-down-logo">
                <use href="icons.svg#chevron-down-logo"></use>
            </svg>
            <svg aria-hidden="true" class="menu-logo">
                <use href="icons.svg#menu-logo"></use>
            </svg>
        </button>
        
    
        <!-- 2) Potência + Consumo -->
        <div class="div2">
            <!-- Potência contratada -->
            <div class="form-group">
                <label for="potenciac">Potência (kVA)</label>
                <select id="potenciac" class="form-control" style="background-color: #375623; color:white;font-weight: bold;">
                    <option value=1.15>1,15</option>
                    <option value=2.3>2,3</option>
                    <option value=3.45>3,45</option>
                    <option value=4.6>4,6</option>
                    <option value=5.75>5,75</option>
                    <option value=6.9 selected>6,9</option>
                    <option value=10.35>10,35</option>
                    <option value=13.8>13,8</option>
                    <option value=17.25>17,25</option>
                    <option value=20.7>20,7</option>
                </select>
            </div>
    
            <!-- Consumo -->
            <div class="form-group">
                <label for="consumoInput">Consumo (kWh)</label>
                <div class="spinner-wrapper">
                  <input
                    type="number"
                    id="consumoInput"
                    class="form-control"
                    style="background-color: #FFC000; font-weight: bold;"
                    value="250"
                    min="0"
                    step="any"
                  />
                  <div class="spinner">
                    <button type="button" class="spinner-btn spinner-up" aria-label="Aumentar Consumo">
                      <svg class="spinner-arrow-svg" width="12" height="8">
                        <use href="icons.svg#arrow-up"></use>
                      </svg>
                    </button>
                    <button type="button" class="spinner-btn spinner-down" aria-label="Diminuir Consumo">
                      <svg class="spinner-arrow-svg" width="12" height="8">
                        <use href="icons.svg#arrow-down"></use>
                      </svg>
                    </button>
                  </div>
                  
                </div>
              </div>
              
        </div>
    
        <!-- 4) div3: esconde à partida, e dentro vem os dois botões + campos -->
        <div class="div3 hidden">
            <!-- 4.1) botões OMIE + Calendário -->
            <div class="switch-buttons">
                <button id="btnShowOmie" class="btn-icon" title="OMIE (€/kWh)">
                    <svg aria-hidden="true" class="omie-logo">
                        <use href="icons.svg#omie-logo"></use>
                      </svg>
                    
                    
        <!-- 4)           <img src="omie-logo.png" alt="OMIE" /> -->
                </button>
                <button id="btnShowCalendar" class="btn-icon" title="Intervalo de datas">
                    <svg aria-hidden="true" class="calendar-logo">
                        <use href="icons.svg#calendar-logo"></use>
                      </svg>                
                    </button>
                <button id="btnShowTs" class="btn-icon" title="Descontos sociais">
                    <svg aria-hidden="true" class="heart-logo">
                        <use href="icons.svg#heart-logo"></use>
                      </svg>              
                </button>
                <button id="btnClearForms" class="btn-limpar-inline" title="Limpar OMIE / Datas / Descontos sociais">
                    <svg aria-hidden="true" class="broom-logo">
                        <use href="icons.svg#broom-logo"></use>
                      </svg>
                </button>
            </div>
        </div>
            
        <!-- 4) div4: painel OMIE -->
        <div class="div4 hidden">
            <div id="omieField" class="form-group">
                <label for="omieInput">OMIE (€/MWh)</label>
                <div class="spinner-wrapper">
                  <input
                    type="number"
                    id="omieInput"
                    class="form-control"
                    step="any"
                    max="10000"
                  >
                  <div class="spinner">
                    <button type="button" class="spinner-btn spinner-up" aria-label="Aumentar OMIE">
                      <svg class="spinner-arrow-svg" width="12" height="8">
                        <use href="icons.svg#arrow-up"></use>
                      </svg>
                    </button>
                    <button type="button" class="spinner-btn spinner-down" aria-label="Diminuir OMIE">
                      <svg class="spinner-arrow-svg" width="12" height="8">
                        <use href="icons.svg#arrow-down"></use>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
        </div>
        
        <!-- 5) div5: painel Datas -->
        <div class="div5 hidden" id="dateRangeFields">
            <div class="date-cell form-group">
                <label for="startDate">Data Início</label>
                <input type="date" id="startDate" class="form-control" min="2025-01-01" max="2025-12-31" />
            </div>
            <div class="date-cell form-group">
                <label for="endDate">Data Fim</label>
                <input type="date" id="endDate" class="form-control" min="2025-01-01" max="2025-12-31" />
            </div>
        </div>
        
        <!-- 6) div6: painel Descontos sociais -->
        <div class="div6 hidden">
            <div id="tsField" class="form-group">
                <label class="form-label">Descontos sociais</label>
                <div id="conteudoTs" class="conteudo-ts" style="background: rgba(255,255,255,0.9); display: block;">
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="radio" name="tsType" value="none" id="tsNone" checked
                            style="margin:0; padding:0; width:16px; height:16px;">
                        <label for="tsNone" style="margin:4px;">Sem tarifa social</label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="radio" name="tsType" value="ts" id="tsTS"
                            style="margin:0; padding:0; width:16px; height:16px;">
                        <label for="tsTS" style="margin:4px;">Tarifa social</label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="radio" name="tsType" value="ts-partial" id="tsPartial"
                            style="margin:0; padding:0; width:16px; height:16px;">
                        <label for="tsPartial" style="margin:4px;">
                            Tarifa social + Isenção parcial CAV (1,85 €/mês)
                        </label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="checkbox" id="familiasNumerosas" style="margin:0; padding:0; width:16px; height:16px;">
                        <label for="familiasNumerosas" style="margin:4px;">Famílias numerosas</label>
                    </div>
                </div>
            </div>
        </div>
          
        <!-- dentro do teu .parent, ao lado de div4 -->
        <button id="btnClearOmie" class="btn-limpar-inline hidden" title="Limpar OMIE">
            <svg aria-hidden="true" class="broom-logo">
                <use href="icons.svg#broom-logo"></use>
              </svg>
        </button>
        
        <!-- ao lado de div5 -->
        <button id="btnClearDates" class="btn-limpar-inline hidden" title="Limpar datas">
            <svg aria-hidden="true" class="broom-logo">
                <use href="icons.svg#broom-logo"></use>
              </svg>
        </button>
        
        <!-- ao lado de div6 -->
        <button id="btnClearTs" class="btn-limpar-inline hidden" title="Limpar descontos sociais">
            <svg aria-hidden="true" class="broom-logo">
                <use href="icons.svg#broom-logo"></use>
              </svg>
        </button>


        
        <button id="btnDefinicoes" class="btn-icon" title="Meu tarifário / Outras opções" data-target="secaoDefinicoes"
            style="width:50px;height:30px;border:1px solid #ccc;border-radius:5px;
                                                 display:flex;align-items:center;justify-content:center;gap:0px;cursor:pointer;">
             <svg aria-hidden="true" class="chevron-down-logo">
                <use href="icons.svg#chevron-down-logo"></use>
             </svg>
             <svg aria-hidden="true" class="menu-logo">
            <use href="icons.svg#menu-logo"></use>
            </svg>
        </button>
    </div>
      


   
    
    
    
        <div id="secaoDefinicoes" style="display: none;">
            <div style="
                    position: relative;
                    margin-top: 10px; 
                    background-color: #e0e0e0;
                    border: 1px solid #bbb;
                    border-bottom-left-radius: 8px;
                    border-top-left-radius: 8px;
                    border-bottom-right-radius: 8px;
                    border-top-right-radius: 8px;
                    padding: 10px 50px 10px 10px;">
        
                <!-- Abas lado a lado -->
                <div style="display: flex;">
                    <div id="abaMeuTarifario" class="aba ativa">Meu tarifário</div>
                    <div id="abaOutrasOpcoes" class="aba">Outras opções</div>
                </div>
        
                <!-- Conteúdo Meu Tarifário -->
                <div id="conteudoMeuTarifario" class="conteudo-aba ativa">
                    <!-- novo: container com 2 colunas -->
                    <div class="form-row-duas-colunas">
                        <div class="form-group">
                            <label for="fixo">Potência (€/dia)</label>
                            <div class="spinner-wrapper">
                              <input
                                type="number"
                                id="fixo"
                                class="form-control"
                                min="0"
                                step="0.01"
                              />
                              <div class="spinner">
                                <button type="button" class="spinner-btn spinner-up" aria-label="Aumentar Potência">
                                  <svg class="spinner-arrow-svg" width="12" height="8">
                                    <use href="icons.svg#arrow-up"></use>
                                  </svg>
                                </button>
                                <button type="button" class="spinner-btn spinner-down" aria-label="Diminuir Potência">
                                  <svg class="spinner-arrow-svg" width="12" height="8">
                                    <use href="icons.svg#arrow-down"></use>
                                  </svg>
                                </button>
                              </div>
                            </div>
                          </div>
                          
                          <div class="form-group">
                            <label for="variavel">Energia (€/kWh)</label>
                            <div class="spinner-wrapper">
                              <input
                                type="number"
                                id="variavel"
                                class="form-control"
                                min="0"
                                step="0.01"
                              />
                              <div class="spinner">
                                <button type="button" class="spinner-btn spinner-up" aria-label="Aumentar Energia">
                                  <svg class="spinner-arrow-svg" width="12" height="8">
                                    <use href="icons.svg#arrow-up"></use>
                                  </svg>
                                </button>
                                <button type="button" class="spinner-btn spinner-down" aria-label="Diminuir Energia">
                                  <svg class="spinner-arrow-svg" width="12" height="8">
                                    <use href="icons.svg#arrow-down"></use>
                                  </svg>
                                </button>
                              </div>
                            </div>
                          </div>
                          
                    </div>
        
                    <!-- Botão de limpeza -->
                    <button id="btnLimpar" class="btn-limpar" title="Limpar Meu tarifário">
                        <svg aria-hidden="true" class="broom-logo">
                            <use href="icons.svg#broom-logo"></use>
                          </svg>
                    </button>
                </div>
        
                <!-- Conteúdo Outras Opções (inicialmente oculto) -->
                <div id="conteudoOutrasOpcoes" class="conteudo-aba">
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="checkbox" id="mostrarNomes" style="margin: 0; padding: 0; width: 16px; height: 16px;">
                        <label for="mostrarNomes" style="margin: 4px;">Exibir nomes completos dos tarifários</label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="checkbox" id="incluirACP" style="margin: 0; padding: 0; width: 16px; height: 16px;">
                        <label for="incluirACP" style="margin: 4px;">Incluir quota mensal no Goldenergy ACP</label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="checkbox" id="incluirContinente" style="margin: 0; padding: 0; width: 16px; height: 16px;">
                        <label for="incluirContinente" style="margin: 4px;">Incluir desconto em Cartão Continente no
                            tarifário Galp Continente</label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="checkbox" id="incluirMeo" style="margin: 0; padding: 0; width: 16px; height: 16px;">
                        <label for="incluirMeo" style="margin: 4px;">Incluir desconto para clientes MEO no tarifário
                            MEO</label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="checkbox" id="restringir" style="margin: 0; padding: 0; width: 16px; height: 16px;">
                        <label for="restringir" style="margin: 4px;">Restringir aos tarifários do simulador Excel</label>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="checkbox" id="incluirEDP" style="margin: 0; padding: 0; width: 16px; height: 16px;">
                        <label for="restringir" style="margin: 4px;">Incluir desconto mensal de 10€ no EDP indexado</label>
                    </div>
        
        
        
                </div>
        
            </div>
        </div>
        

        
        
        
        <div id="resultado"></div>
        
        <div id="listaTarifarios"></div>
        
        
        
        <div id="postTableContent" class="post-table-content">
            <!-- Caixa de título com cantos arredondados -->
            <div class="reveal">
                <div class="titulo-omie"
                     style="
                       background-color: #f3e29f;
                       padding: 12px;
                       font-family: sans-serif;
                       text-align: center;
                       border-radius: 12px;
                       margin-bottom: 0;
                       box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                     ">
                  <div style="font-weight: bold; font-size: 16px; margin-bottom:4px;">
                    Preços OMIE em €/MWh
                  </div>
                  <div style="font-size: 14px; font-style: italic; margin-bottom:4px;">
                    (corrigidos para a hora portuguesa)
                  </div>
                  <div style="font-weight: bold; font-size: 16px;">
                    Valor médio do ciclo mensal até cada data
                  </div>
                </div>
              </div>
        
    <div class="reveal">
        <!-- Gráfico -->
        <div class="grafico-wrapper">
            <iframe
              id="grafico"
              data-src="gs/grafico_omie_plotly.html"
              title="OMIE e Projeção"
              width="800"
              height="450"
              <!-- loading="lazy"-->
              style="border:none; position:absolute; inset:0;"
            ></iframe>
        </div>
    </div>  
        
        <div style="text-align: center; margin-top: 20px;">
            <!-- Botão para baixar Excel -->
            <a href="https://docs.google.com/spreadsheets/d/1PhbpG35wn4aF4XA-FQHKgowr3iCvEprp/export?format=xlsx"
                class="botao-excel">📥 Descarregar Excel</a>
        
            <!-- Botão para abrir Google Sheets -->
            <a href="https://docs.google.com/spreadsheets/d/1PhbpG35wn4aF4XA-FQHKgowr3iCvEprp" target="_blank"
                class="botao-sheet">📂 Abrir Google Sheets</a>
        </div>
        
        <div class="reveal footer-custom" style="text-align: center; margin-top: 30px; font-size: 14px; color: #666;">
            <!-- teu conteúdo de rodapé -->
            <div>
                <a href="https://www.youtube.com/@oscarfelgueiras8837" target="_blank"
                    style="text-decoration: none; margin-right: 15px;">
                    <img src="YouTube_full-color_icon.png" alt="YouTube"
                    width="36"
                    height="25"
                    style="height:25px; width:36px;">
                </a>
                <a href="https://x.com/ofelgueiras2" target="_blank" style="text-decoration: none; display: inline-block; overflow: hidden;">
                    <img
                      src="X_icon_2.svg"
                      width="25"
                      height="25"
                      alt="X (Twitter)"
                      style="border-radius: 4px; display: block;"
                    >
                  </a>
                  
            </div>
            <div style="margin-top: 10px;">
                <img src="favicon-32x32.png" alt="Ícone de Óscar Felgueiras"
                    style="width: 32px; height: 32px; border-radius: 50%; vertical-align: middle;">
                <span style="margin-left: 8px;">© 2025 Óscar Felgueiras</span>
            </div>
        </div>
    </div>   
    <!-- 1) Carrega as dependências externas -->
  <script src="https://unpkg.com/@popperjs/core@2" defer></script>
  <script src="https://unpkg.com/tippy.js@6" defer></script>
  
    <script src="/script.js"></script>
        </body>
        
        </html>    
    
